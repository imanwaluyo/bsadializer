<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>HD Clinical Decision Support - Iman Waluyo</title>

<style>
body{
font-family:'Segoe UI',Arial;
margin:0;
background:#f4f6f9;
}

.header{
background:#0d47a1;
color:white;
padding:18px;
text-align:center;
}

.header h1{margin:0;font-weight:600;}
.header p{margin:4px 0;font-size:13px;}

.navbar{
display:flex;
justify-content:center;
background:white;
box-shadow:0 2px 8px rgba(0,0,0,0.08);
}

.navbar button{
background:none;
border:none;
padding:14px 22px;
cursor:pointer;
font-size:14px;
font-weight:500;
color:#555;
transition:0.3s;
}

.navbar button.active{
color:#0d47a1;
border-bottom:3px solid #0d47a1;
}

.navbar button:hover{
background:#f0f4ff;
}

.card{
display:none;
max-width:900px;
margin:30px auto;
background:white;
padding:30px;
border-radius:10px;
box-shadow:0 5px 20px rgba(0,0,0,0.08);
}

.card.active{display:block;}

input, select{
width:100%;
padding:8px;
margin:6px 0 14px 0;
border-radius:6px;
border:1px solid #ddd;
font-size:14px;
}

.actions{
display:flex;
justify-content:flex-end;
gap:8px;
margin-top:10px;
}

.actions button{
padding:6px 14px;
font-size:12px;
border-radius:6px;
border:none;
cursor:pointer;
}

.btn-calc{background:#0d47a1;color:white;}
.btn-clear{background:#9e9e9e;color:white;}
.btn-print{background:#424242;color:white;}

.result{
margin-top:18px;
padding:15px;
background:#eef3ff;
border-left:4px solid #0d47a1;
border-radius:6px;
font-size:14px;
line-height:1.6;
}

h2{margin-top:0;color:#0d47a1;}
h3{margin-bottom:5px;color:#0d47a1;}
hr{margin:15px 0;}
</style>
</head>

<body>

<div class="header">
<h1>HD Clinical Decision Support System</h1>
<p>Dialyzer Selection • Adequacy • Fluid Assessment</p>
<p>Created by Iman Waluyo</p>
</div>

<div class="navbar">
<button class="active" onclick="showTab('dializer',this)">Dialyzer</button>
<button onclick="showTab('ktv',this)">Adekuasi & Program</button>
<button onclick="showTab('teori',this)">Teori</button>
</div>

<!-- ================= DIALYZER ================= -->
<div id="dializer" class="card active">

<h2>Kalkulator BSA & Rekomendasi Dialyzer</h2>

<label>Kategori Pasien</label>
<select id="kategori">
<option value="anak">Anak (Pediatrik)</option>
<option value="dewasa">Dewasa</option>
</select>

<label>Berat Badan (kg)</label>
<input type="number" id="bb">

<label>Tinggi Badan (cm)</label>
<input type="number" id="tb">

<div class="actions">
<button class="btn-calc" onclick="hitungBSA()">Hitung</button>
<button class="btn-clear" onclick="clearBSA()">Clear</button>
<button class="btn-print" onclick="window.print()">Print</button>
</div>

<div id="hasilBSA" class="result" style="display:none;"></div>
</div>

<!-- ================= ADEKUASI ================= -->
<div id="ktv" class="card">

<h2>Adekuasi & Program Dialisis</h2>

<label>Berat Badan saat HD (kg)</label>
<input type="number" id="bb2">

<label>BUN Pre (mg/dL)</label>
<input type="number" id="bunpre">

<label>BUN Post (mg/dL)</label>
<input type="number" id="bunpost">

<label>Durasi Dialisis (jam)</label>
<input type="number" id="durasi">

<label>Ultrafiltrasi Aktual (Liter)</label>
<input type="number" id="uf">

<hr>

<h3>Pengkajian Klinis</h3>

<label>Berat Badan Kering (kg)</label>
<input type="number" id="bbkering">

<label>BB Sekarang / Pre-HD (kg)</label>
<input type="number" id="bbsekarang">

<label>Kondisi Edema</label>
<select id="edema">
<option value="tidak">Tidak Ada</option>
<option value="ringan">Ringan</option>
<option value="sedang">Sedang</option>
<option value="berat">Berat</option>
</select>

<label>Keluhan Sesak</label>
<select id="sesak">
<option value="tidak">Tidak</option>
<option value="ya">Ya</option>
</select>

<div class="actions">
<button class="btn-calc" onclick="hitungKTV()">Hitung</button>
<button class="btn-clear" onclick="clearKTV()">Clear</button>
<button class="btn-print" onclick="window.print()">Print</button>
</div>

<div id="hasilKTV" class="result" style="display:none;"></div>
</div>

<!-- ================= TEORI ================= -->
<div id="teori" class="card">
<h2>Referensi Ilmiah</h2>
Mosteller 1987 – Rumus BSA<br>
Daugirdas II Formula – JASN 1993<br>
KDOQI Hemodialysis Adequacy 2015 Update<br>
KDIGO CKD Guideline 2023<br>
Daugirdas Handbook of Dialysis 6th Ed 2023<br>
Flythe et al. UF Rate & Mortality CJASN 2021–2023
</div>

<script>

function showTab(id,btn){
document.querySelectorAll(".card").forEach(c=>c.classList.remove("active"));
document.querySelectorAll(".navbar button").forEach(b=>b.classList.remove("active"));
document.getElementById(id).classList.add("active");
btn.classList.add("active");
}

/* ================= DIALYZER ================= */

function pilihDializer(area){
if (area <= 0.8) return {nama:"High Flux 70", luas:0.7};
else if (area <= 1.05) return {nama:"High Flux 90", luas:0.9};
else if (area <= 1.40) return {nama:"High Flux 130", luas:1.3};
else return {nama:"High Flux 150", luas:1.5};
}

function hitungBSA(){
let bb=parseFloat(document.getElementById("bb").value);
let tb=parseFloat(document.getElementById("tb").value);
let kategori=document.getElementById("kategori").value;

if(!bb||!tb||bb<=0||tb<=0){alert("Data tidak valid");return;}

let bsa=Math.sqrt((tb*bb)/3600);
let min,max;

if(kategori==="anak"){min=bsa*0.8; max=bsa*1.0;}
else{min=bsa*1.0; max=bsa*1.2;}

let target=(min+max)/2;
let dial=pilihDializer(target);
let rasio=(dial.luas/bsa)*100;

document.getElementById("hasilBSA").style.display="block";
document.getElementById("hasilBSA").innerHTML=
`<b>BSA:</b> ${bsa.toFixed(2)} m²<br>
<b>Rekomendasi:</b> ${dial.nama}<br>
<b>Rasio ke BSA:</b> ${rasio.toFixed(1)}%`;
}

function clearBSA(){
document.getElementById("bb").value="";
document.getElementById("tb").value="";
document.getElementById("hasilBSA").style.display="none";
}

/* ================= ADEKUASI ================= */

function hitungKTV(){

let bb=parseFloat(document.getElementById("bb2").value);
let pre=parseFloat(document.getElementById("bunpre").value);
let post=parseFloat(document.getElementById("bunpost").value);
let t=parseFloat(document.getElementById("durasi").value);
let uf=parseFloat(document.getElementById("uf").value);

let bbkering=parseFloat(document.getElementById("bbkering").value);
let bbsekarang=parseFloat(document.getElementById("bbsekarang").value);
let edema=document.getElementById("edema").value;
let sesak=document.getElementById("sesak").value;

if(!bb||!pre||!post||!t||!uf||!bbkering||!bbsekarang){alert("Lengkapi data");return;}
if(post>=pre){alert("BUN Post tidak boleh ≥ BUN Pre");return;}

let urr=((pre-post)/pre)*100;
let R=post/pre;
let ktv=-Math.log(R-(0.008*t))+((4-(3.5*R))*(uf/bb));

let idwg=bbsekarang-bbkering;
let ufRate=(uf*1000)/(bbkering*t);

document.getElementById("hasilKTV").style.display="block";
document.getElementById("hasilKTV").innerHTML=
`<b>URR:</b> ${urr.toFixed(1)}%<br>
<b>spKt/V:</b> ${ktv.toFixed(2)}<br>
<hr>
<b>IDWG:</b> ${idwg.toFixed(2)} kg<br>
<b>UF Rate:</b> ${ufRate.toFixed(1)} mL/kg/jam`;
}

function clearKTV(){
document.querySelectorAll("#ktv input").forEach(i=>i.value="");
document.getElementById("hasilKTV").style.display="none";
}

</script>

</body>
  </html>
